<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Neko: fast3d Module Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Neko<span id="projectnumber">&#160;1.99.2</span>
   </div>
   <div id="projectbrief">A portable framework for high-order spectral element flow simulations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dc/d5b/namespacefast3d.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">fast3d Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Fast diagonalization methods from NEKTON.  
</p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a8cf69d1d964e71a541204bd6c2fc41c4" id="r_a8cf69d1d964e71a541204bd6c2fc41c4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">subroutine</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">public</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d5b/namespacefast3d.html#a8cf69d1d964e71a541204bd6c2fc41c4">fd_weights_full</a> (<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">xi</a>, x, n, m, c)</td></tr>
<tr class="memdesc:a8cf69d1d964e71a541204bd6c2fc41c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute finite-difference stencil weights for evaluating derivatives up to order \(m\) at a point.  <br /></td></tr>
<tr class="separator:a8cf69d1d964e71a541204bd6c2fc41c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71d142b2e4b813e2a446dc2cae7d47a4" id="r_a71d142b2e4b813e2a446dc2cae7d47a4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">subroutine</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">public</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d5b/namespacefast3d.html#a71d142b2e4b813e2a446dc2cae7d47a4">semhat</a> (<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">a</a>, b, c, d, z, <a class="el" href="../../dd/df0/namespacespeclib.html#a05661077bac4533389e8ad59f95a6c9d">dgll</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">jgll</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">bgl</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">zgl</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dgl</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">jgl</a>, n, w)</td></tr>
<tr class="memdesc:a71d142b2e4b813e2a446dc2cae7d47a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate matrices for single element, 1D operators: a = Laplacian b = diagonal mass matrix c = convection operator b*d d = derivative matrix dgll = derivative matrix, mapping from pressure nodes to velocity jgll = interpolation matrix, mapping from pressure nodes to velocity z = GLL points.  <br /></td></tr>
<tr class="separator:a71d142b2e4b813e2a446dc2cae7d47a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf25d1aac3262e9adea18d25b10b2ddc" id="r_aaf25d1aac3262e9adea18d25b10b2ddc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">subroutine</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">public</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d5b/namespacefast3d.html#aaf25d1aac3262e9adea18d25b10b2ddc">setup_intp</a> (<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">jh</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">jht</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">z_to</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">z_from</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">n_to</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">n_from</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">derivative</a>)</td></tr>
<tr class="memdesc:aaf25d1aac3262e9adea18d25b10b2ddc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute interpolation weights for points <code>z_to</code> using values at points <code>z_from</code>.  <br /></td></tr>
<tr class="separator:aaf25d1aac3262e9adea18d25b10b2ddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a8cf69d1d964e71a541204bd6c2fc41c4" name="a8cf69d1d964e71a541204bd6c2fc41c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cf69d1d964e71a541204bd6c2fc41c4">&#9670;&#160;</a></span>fd_weights_full()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">subroutine</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">public</a> fast3d::fd_weights_full </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">in</a>)&#160;</td>
          <td class="paramname"><em>xi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(0:n), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">in</a>)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">integer</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">in</a>)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">integer</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">in</a>)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(0:n,0:m), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">out</a>)&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine comes from the Appendix C of "A Practical Guide to Pseudospectral Methods" by B. Fornberg, Cambridge University Press, 1996.</p>
<p>Given gridpoints \( x_0, x_1, \dots x_n \) and some point \(\xi\) (not necessarily a grid point!) find weights \( c_{j, k} \), such that the expansions \( \frac{d^k f}{d x^k}|_{x=\xi} \approx \sum_{j=0}^n c_{j,k} f(x_j)\), \(k=0, \dots m\) are optimal. Note that finite-difference stencils are exactly such type of expansions. For the derivation of the algorithm, refer to 3.1 in the reference above.</p>
<dl class="section note"><dt>Note</dt><dd>- Setting \(m=0\) makes this a polynomial interpolation routine. It is the fastest such routine possible for a single interpolation point, according to the above reference. </dd>
<dd>
- The name <code>_full</code> refers to the fact that we use the values \(f(x_j)\) at all available nodes \(x\) to construct the expansion. So we always get the finite difference stencil of maximum order possible.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The calculation of the wieghts is numerically stable. But applying the weights to a function can be ill-conditioned in the case of high-order derivatives.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">xi</td><td>Point at which the approximations are to be accurate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">x</td><td>The coordinates for the grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>The size of <code>x</code> is <code>n + 1</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Highest order of derivative to be approximated </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">c</td><td>The stencil weights. Row j corresponds to weight of \(f(x_j)\) and column k to the kth derivative </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d90/fast3d_8f90_source.html#l00104">104</a> of file <a class="el" href="../../dd/d90/fast3d_8f90_source.html">fast3d.f90</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dc/d5b/namespacefast3d_a8cf69d1d964e71a541204bd6c2fc41c4_icgraph.png" border="0" usemap="#adc/d5b/namespacefast3d_a8cf69d1d964e71a541204bd6c2fc41c4_icgraph" alt=""/></div>
<map name="adc/d5b/namespacefast3d_a8cf69d1d964e71a541204bd6c2fc41c4_icgraph" id="adc/d5b/namespacefast3d_a8cf69d1d964e71a541204bd6c2fc41c4_icgraph">
<area shape="rect" title="Compute finite&#45;difference stencil weights for evaluating derivatives up to order &#160;at a point." alt="" coords="1009,383,1180,408"/>
<area shape="rect" href="../../dd/dd2/namespacedofmap.html#a971e44364f26c18dcc5aeaa06ab7d50d" title="Generate the x, y, z coordinates of the dofs in a signle element, assuming linear element edges." alt="" coords="768,5,944,31"/>
<area shape="poly" title=" " alt="" coords="1088,370,1079,305,1057,220,1040,174,1019,130,992,88,960,52,928,33,931,29,963,48,996,85,1023,127,1045,172,1062,218,1084,304,1094,369"/>
<area shape="rect" href="../../dd/dd2/namespacedofmap.html#adb78d2dd3cc039858605775479de13ca" title=" " alt="" coords="498,56,690,81"/>
<area shape="poly" title=" " alt="" coords="1088,369,1078,310,1056,234,1039,195,1018,158,992,124,960,96,924,76,884,61,843,52,801,48,720,49,652,59,651,53,719,44,801,43,843,47,886,56,926,71,963,92,995,120,1022,155,1044,193,1061,233,1083,309,1093,368"/>
<area shape="rect" href="../../da/d80/namespacelocal__interpolation.html#a6c4f297f530766d411e494aec53fb8e4" title="Constructs the Jacobian, returns a 3&#45;by&#45;3 times number of points where ." alt="" coords="785,106,927,146"/>
<area shape="poly" title=" " alt="" coords="1083,370,1068,324,1042,268,1006,210,984,183,960,160,926,142,929,137,963,156,988,180,1011,207,1047,265,1072,322,1088,368"/>
<area shape="rect" href="../../da/d80/namespacelocal__interpolation.html#a0349147244f7d71fcb553ff667630974" title="Computes interpolation weights &#160;for a list of points." alt="" coords="784,171,928,225"/>
<area shape="poly" title=" " alt="" coords="1076,372,1029,306,997,270,960,239,927,221,929,216,963,234,1000,266,1033,303,1081,369"/>
<area shape="rect" href="../../df/d77/namespacepoint__interpolator.html#af81d2b24f9d9cb447b62493589af79dc" title="Computes interpolation weights &#160;for a list of points." alt="" coords="783,249,929,304"/>
<area shape="poly" title=" " alt="" coords="1062,377,1015,348,960,318,929,304,931,299,963,313,1018,343,1065,373"/>
<area shape="rect" href="../../df/d77/namespacepoint__interpolator.html#a64e971149142558d588444108afeadd7" title="Constructs the Jacobian, returns a 3&#45;by&#45;3 array where ." alt="" coords="775,328,937,383"/>
<area shape="poly" title=" " alt="" coords="1004,383,937,372,938,366,1005,378"/>
<area shape="rect" href="../../df/d77/namespacepoint__interpolator.html#a3ce7a12216763251e60ca0eea95dc73f" title="Interpolates a scalar field &#160;on a set of &#160;points . Returns a vector of N coordinates ." alt="" coords="783,485,929,540"/>
<area shape="poly" title=" " alt="" coords="1064,418,963,475,931,489,929,484,960,470,1061,413"/>
<area shape="rect" href="../../df/d77/namespacepoint__interpolator.html#ac630f7f5fa9981e4aadb9eaea38265d9" title="Interpolates a vector field &#160;on a set of &#160;points . Returns an array of N points ." alt="" coords="782,564,930,619"/>
<area shape="poly" title=" " alt="" coords="1081,421,1033,486,1000,522,963,554,932,571,929,566,960,549,996,518,1029,483,1076,418"/>
<area shape="rect" href="../../df/d77/namespacepoint__interpolator.html#a68f8d5c9b43d725b529982d525e4f51d" title="Interpolates a vector field &#160;and constructs the Jacobian at a point . Returns a vector ." alt="" coords="751,407,961,461"/>
<area shape="poly" title=" " alt="" coords="1002,413,962,420,961,414,1001,408"/>
<area shape="rect" href="../../dc/d5b/namespacefast3d.html#a71d142b2e4b813e2a446dc2cae7d47a4" title="Generate matrices for single element, 1D operators: a = Laplacian b = diagonal mass matrix c = convec..." alt="" coords="796,643,916,668"/>
<area shape="poly" title=" " alt="" coords="1089,423,1073,468,1047,525,1011,583,989,609,963,632,941,645,917,652,915,647,939,640,960,628,985,606,1007,580,1043,523,1068,466,1084,421"/>
<area shape="rect" href="../../dc/d5b/namespacefast3d.html#aaf25d1aac3262e9adea18d25b10b2ddc" title="Compute interpolation weights for points z_to using values at points z_from." alt="" coords="787,692,925,717"/>
<area shape="poly" title=" " alt="" coords="1092,422,1079,477,1055,547,1038,584,1017,620,992,653,963,681,946,692,927,700,925,695,943,688,960,677,988,649,1013,617,1033,581,1050,545,1074,475,1086,421"/>
<area shape="rect" href="../../d7/d12/namespacetime__interpolator.html#ad9f0c1c65b7a06117a9c020c3e0db745" title="Interpolate a scalar field at time t from known scalar fields at different time steps." alt="" coords="765,742,947,782"/>
<area shape="poly" title=" " alt="" coords="1093,422,1083,485,1060,568,1043,612,1022,656,995,696,963,732,946,744,943,740,960,728,991,693,1017,653,1039,610,1055,566,1078,484,1088,421"/>
<area shape="rect" href="../../dd/dd2/namespacedofmap.html#a5d369623e2bb954910d6741afd4e93a8" title="Generate x,y,z&#45;coordinates for all dofs." alt="" coords="212,31,437,56"/>
<area shape="poly" title=" " alt="" coords="755,25,438,41,437,35,754,20"/>
<area shape="poly" title=" " alt="" coords="777,36,661,59,660,53,776,31"/>
<area shape="rect" href="../../dd/dd2/namespacedofmap.html#ab00433635f8523e38ff52650bdbe62c0" title="Constructor." alt="" coords="5,31,164,56"/>
<area shape="poly" title=" " alt="" coords="198,46,164,46,164,41,198,41"/>
<area shape="poly" title=" " alt="" coords="484,61,438,57,438,51,485,56"/>
<area shape="rect" href="../../da/d80/namespacelocal__interpolation.html#aeef5a68b5719a6d3638ce8a2be899ab7" title=" " alt="" coords="523,106,665,146"/>
<area shape="poly" title=" " alt="" coords="771,129,666,129,666,123,771,123"/>
<area shape="rect" href="../../d6/d23/structpoint__interpolator_1_1point__interpolator__t.html#a6ee5651038f20bfc882ad218a441df67" title="Constructs the Jacobian for a point ." alt="" coords="521,388,667,443"/>
<area shape="poly" title=" " alt="" coords="762,380,668,401,667,396,761,374"/>
<area shape="rect" href="../../d6/d23/structpoint__interpolator_1_1point__interpolator__t.html#aab6f88f93726243081532875040a3cbe" title="Interpolates a scalar or vector field on a set of points." alt="" coords="521,505,667,560"/>
<area shape="poly" title=" " alt="" coords="769,522,668,530,667,524,769,517"/>
<area shape="poly" title=" " alt="" coords="768,574,667,552,668,546,769,569"/>
<area shape="poly" title=" " alt="" coords="736,428,667,423,668,418,737,423"/>
<area shape="rect" href="../../d3/d4c/namespacefdm.html#a4e4c35e30cb7a09ac9f75e02ca5c6acb" title=" " alt="" coords="539,643,649,668"/>
<area shape="poly" title=" " alt="" coords="782,658,650,658,650,653,782,653"/>
<area shape="rect" href="../../d9/da0/namespaceinterpolation.html#ad32c9456866b0fda31f8dce40e54bc71" title="Constructor to initialize with two different spaces." alt="" coords="485,692,703,717"/>
<area shape="poly" title=" " alt="" coords="773,707,703,707,703,702,773,702"/>
<area shape="rect" href="../../d5/d0d/namespacespace.html#aea7cdf9a8933056da79e3b73f4e0ed49" title="Initialize a function space s with given polynomial dimensions." alt="" coords="527,741,661,767"/>
<area shape="poly" title=" " alt="" coords="775,723,662,744,661,739,774,717"/>
</map>
</div>

</div>
</div>
<a id="a71d142b2e4b813e2a446dc2cae7d47a4" name="a71d142b2e4b813e2a446dc2cae7d47a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71d142b2e4b813e2a446dc2cae7d47a4">&#9670;&#160;</a></span>semhat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">subroutine</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">public</a> fast3d::semhat </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(0:n,0:n), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">inout</a>)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(0:n), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">inout</a>)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(0:n,0:n), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">inout</a>)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(0:n,0:n), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">inout</a>)&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(0:n), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">inout</a>)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(0:n,1:n-1), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">inout</a>)&#160;</td>
          <td class="paramname"><em>dgll</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(0:n,1:n-1), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">inout</a>)&#160;</td>
          <td class="paramname"><em>jgll</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(1:n-1), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">inout</a>)&#160;</td>
          <td class="paramname"><em>bgl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(1:n-1), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">inout</a>)&#160;</td>
          <td class="paramname"><em>zgl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(1:n-1,0:n), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">inout</a>)&#160;</td>
          <td class="paramname"><em>dgl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(1:n-1,0:n), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">inout</a>)&#160;</td>
          <td class="paramname"><em>jgl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">integer</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">in</a>)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(0:2*n+1), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">inout</a>)&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>zgl = GL points bgl = diagonal mass matrix on GL dgl = derivative matrix, mapping from velocity nodes to pressure jgl = interpolation matrix, mapping from velocity nodes to pressure</p>
<p>n = polynomial degree (velocity space) w = work array of size 2*n+2</p>
<p>Currently, this is set up for pressure nodes on the interior GLL pts. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/d90/fast3d_8f90_source.html#l00168">168</a> of file <a class="el" href="../../dd/d90/fast3d_8f90_source.html">fast3d.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dc/d5b/namespacefast3d_a71d142b2e4b813e2a446dc2cae7d47a4_cgraph.png" border="0" usemap="#adc/d5b/namespacefast3d_a71d142b2e4b813e2a446dc2cae7d47a4_cgraph" alt=""/></div>
<map name="adc/d5b/namespacefast3d_a71d142b2e4b813e2a446dc2cae7d47a4_cgraph" id="adc/d5b/namespacefast3d_a71d142b2e4b813e2a446dc2cae7d47a4_cgraph">
<area shape="rect" title="Generate matrices for single element, 1D operators: a = Laplacian b = diagonal mass matrix c = convec..." alt="" coords="5,128,125,153"/>
<area shape="rect" href="../../dd/df0/namespacespeclib.html#a05661077bac4533389e8ad59f95a6c9d" title="Compute the derivative matrix D and its transpose DT associated with the Nth order Lagrangian interpo..." alt="" coords="209,29,309,55"/>
<area shape="poly" title=" " alt="" coords="80,126,120,95,172,64,195,55,197,60,175,68,123,99,83,130"/>
<area shape="rect" href="../../dc/d5b/namespacefast3d.html#a8cf69d1d964e71a541204bd6c2fc41c4" title="Compute finite&#45;difference stencil weights for evaluating derivatives up to order &#160;at a point." alt="" coords="173,79,344,104"/>
<area shape="poly" title=" " alt="" coords="115,125,194,105,195,110,116,131"/>
<area shape="rect" href="../../dd/d47/namespacemath.html#accd3b06fc22b453552cc46d0fbf80677" title="Zero a real vector." alt="" coords="210,128,307,153"/>
<area shape="poly" title=" " alt="" coords="125,138,196,138,196,143,125,143"/>
<area shape="rect" href="../../dd/df0/namespacespeclib.html#acf61de5c4c6c150e008f2f7981ca10db" title="Generate NP Gauss Legendre points Z and weights W associated with Jacobi polynomial ...." alt="" coords="205,227,312,252"/>
<area shape="poly" title=" " alt="" coords="83,151,123,182,175,213,194,221,192,226,172,218,120,186,80,156"/>
<area shape="rect" href="../../dd/df0/namespacespeclib.html#a35488656016cc28e6422a81377ee7434" title="Generate NP Gauss&#45;Lobatto Legendre points (Z) and weights (W) associated with Jacobi polynomial P(N)(..." alt="" coords="203,177,314,203"/>
<area shape="poly" title=" " alt="" coords="116,151,195,171,194,176,115,156"/>
<area shape="rect" href="../../dd/df0/namespacespeclib.html#a9cd5b9e4223625494d9a0acd3be8f85e" title="Compute the value of the Nth order Legendre polynomial at Z. (Simpler than JACOBF) Based on the recur..." alt="" coords="392,29,504,55"/>
<area shape="poly" title=" " alt="" coords="309,39,378,39,378,45,309,45"/>
<area shape="poly" title=" " alt="" coords="421,31,415,21,418,11,429,5,448,3,470,6,480,15,476,19,468,11,448,8,431,10,422,15,420,20,425,28"/>
<area shape="rect" href="../../dd/df0/namespacespeclib.html#a5c35429298522dea2bd177d45c7efc2c" title="Generate NP GAUSS JACOBI points (Z) and weights (W) associated with Jacobi polynomial P(N)(alpha&gt;&#45;1,..." alt="" coords="558,227,665,252"/>
<area shape="poly" title=" " alt="" coords="312,237,544,237,544,242,312,242"/>
<area shape="rect" href="../../dd/df0/namespacespeclib.html#a80692f5a33b00328a2600d1d409035f7" title="Generate NP GAUSS JACOBI points (Z) and weights (W) associated with Jacobi polynomial P(N)(alpha&gt;&#45;1,..." alt="" coords="721,227,835,252"/>
<area shape="poly" title=" " alt="" coords="665,237,707,237,707,242,665,242"/>
<area shape="rect" href="../../dd/df0/namespacespeclib.html#a4048cd0103898d95f6f8064c13fe5294" title=" " alt="" coords="1056,127,1187,152"/>
<area shape="poly" title=" " alt="" coords="802,224,840,205,884,187,965,165,1042,149,1043,154,966,170,886,193,842,210,804,229"/>
<area shape="rect" href="../../dd/df0/namespacespeclib.html#a42f3304560e837ccc11d02fac0d17598" title="Compute NP Gauss points XJAC, which are the zeros of the Jacobi polynomial J(NP) with parameters ALPH..." alt="" coords="895,328,998,353"/>
<area shape="poly" title=" " alt="" coords="799,250,887,306,909,319,906,324,884,311,796,254"/>
<area shape="rect" href="../../dd/df0/namespacespeclib.html#a7b6b7a991f7a4deaff63144237f6b161" title="Computes the Jacobi polynomial (POLY) and its derivative (PDER) of degree N at X." alt="" coords="1063,328,1179,353"/>
<area shape="poly" title=" " alt="" coords="823,250,1065,322,1063,327,821,255"/>
<area shape="rect" href="../../dd/df0/namespacespeclib.html#a3d3ffb215920d3ac2599832211842480" title=" " alt="" coords="885,227,1008,252"/>
<area shape="poly" title=" " alt="" coords="836,237,872,237,872,242,836,242"/>
<area shape="poly" title=" " alt="" coords="1092,128,1086,118,1090,109,1102,102,1121,100,1145,104,1155,112,1152,116,1143,108,1121,105,1103,107,1094,112,1092,118,1097,125"/>
<area shape="poly" title=" " alt="" coords="998,338,1049,338,1049,343,998,343"/>
<area shape="poly" title=" " alt="" coords="969,224,1085,157,1088,161,971,229"/>
<area shape="poly" title=" " alt="" coords="919,228,913,218,916,209,927,202,947,200,970,203,980,212,976,216,967,208,947,205,929,207,920,212,918,218,923,225"/>
<area shape="rect" href="../../dd/df0/namespacespeclib.html#a5b864c5653986341347795cb5ac75c92" title="Generate NP GAUSS LOBATTO JACOBI points (Z) and weights (W) associated with Jacobi polynomial P(N)(al..." alt="" coords="393,176,503,201"/>
<area shape="poly" title=" " alt="" coords="314,187,379,186,379,192,315,192"/>
<area shape="rect" href="../../dd/df0/namespacespeclib.html#a47a06503ffdba7aebba5ae4f41661c04" title="Generate NP GAUSS LOBATTO JACOBI points (Z) and weights (W) associated with Jacobi polynomial P(N)(al..." alt="" coords="552,176,671,201"/>
<area shape="poly" title=" " alt="" coords="504,186,538,186,538,191,504,191"/>
<area shape="poly" title=" " alt="" coords="655,199,723,220,721,225,653,204"/>
<area shape="poly" title=" " alt="" coords="648,199,672,213,697,238,720,263,798,325,835,345,886,363,933,371,982,370,1028,364,1068,354,1070,360,1029,369,982,376,933,376,885,369,833,350,795,329,717,267,693,241,669,217,645,204"/>
<area shape="rect" href="../../dd/df0/namespacespeclib.html#ac3838666020ca4150da3b691fe5f9c93" title=" " alt="" coords="887,101,1006,127"/>
<area shape="poly" title=" " alt="" coords="669,173,875,127,876,132,670,179"/>
<area shape="rect" href="../../dd/df0/namespacespeclib.html#ae4d2f7c4f8ec88a4c0b11d7fb67b87ad" title=" " alt="" coords="719,57,837,83"/>
<area shape="poly" title=" " alt="" coords="629,174,746,89,749,93,632,178"/>
<area shape="poly" title=" " alt="" coords="1007,120,1043,125,1042,131,1006,125"/>
<area shape="poly" title=" " alt="" coords="919,103,913,93,916,83,927,77,947,75,970,78,980,87,976,91,967,83,947,80,929,82,920,87,918,92,923,100"/>
<area shape="poly" title=" " alt="" coords="837,56,919,50,965,53,1009,62,1058,86,1097,115,1094,119,1055,90,1007,67,964,58,919,56,838,61"/>
<area shape="poly" title=" " alt="" coords="750,59,744,49,748,39,759,33,778,31,801,34,810,43,807,47,798,39,778,36,761,38,752,43,750,48,755,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dc/d5b/namespacefast3d_a71d142b2e4b813e2a446dc2cae7d47a4_icgraph.png" border="0" usemap="#adc/d5b/namespacefast3d_a71d142b2e4b813e2a446dc2cae7d47a4_icgraph" alt=""/></div>
<map name="adc/d5b/namespacefast3d_a71d142b2e4b813e2a446dc2cae7d47a4_icgraph" id="adc/d5b/namespacefast3d_a71d142b2e4b813e2a446dc2cae7d47a4_icgraph">
<area shape="rect" title="Generate matrices for single element, 1D operators: a = Laplacian b = diagonal mass matrix c = convec..." alt="" coords="164,5,284,31"/>
<area shape="rect" href="../../d3/d4c/namespacefdm.html#a4e4c35e30cb7a09ac9f75e02ca5c6acb" title=" " alt="" coords="5,5,116,31"/>
<area shape="poly" title=" " alt="" coords="150,21,116,21,116,15,150,15"/>
</map>
</div>

</div>
</div>
<a id="aaf25d1aac3262e9adea18d25b10b2ddc" name="aaf25d1aac3262e9adea18d25b10b2ddc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf25d1aac3262e9adea18d25b10b2ddc">&#9670;&#160;</a></span>setup_intp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">subroutine</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">public</a> fast3d::setup_intp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">n_to</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">n_from</a>), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">inout</a>)&#160;</td>
          <td class="paramname"><em>jh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">n_from</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">n_to</a>), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">inout</a>)&#160;</td>
          <td class="paramname"><em>jht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">n_to</a>), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">in</a>)&#160;</td>
          <td class="paramname"><em>z_to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">kind</a>=rp), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">dimension</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">n_from</a>), <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">in</a>)&#160;</td>
          <td class="paramname"><em>z_from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">integer</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">in</a>)&#160;</td>
          <td class="paramname"><em>n_to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">integer</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">in</a>)&#160;</td>
          <td class="paramname"><em>n_from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">integer</a>, <a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">intent</a>(<a class="el" href="../../db/d11/cuda_2dirichlet__kernel_8h.html#ac2cb217184f95ca86456f610f72bd533">in</a>)&#160;</td>
          <td class="paramname"><em>derivative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is essentially a wrapper for calling fd_weights_full() for several points. For each point in <code>z_to</code>, we get a set of interpolation weights of size <code>n_from</code>. The result is thus a matrix of weights, each row corresponding to a point in <code>z_to</code> and each column the weight of a point in <code>z_from</code>.</p>
<p>This routine is used for interpolating between elements of different polynomial order. In other words, belonging to different <a class="el" href="../../da/d99/structspace_1_1space__t.html">space::space_t</a> . The points are then GL, GLL, etc., depending on the space.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jh</td><td>Matrix of the interpolation weights. </td></tr>
    <tr><td class="paramname">jht</td><td>Same as <code>jh</code> but transposed. </td></tr>
    <tr><td class="paramname">z_to</td><td>Target points for interpolation. </td></tr>
    <tr><td class="paramname">z_from</td><td>Quadrature points. </td></tr>
    <tr><td class="paramname">n_to</td><td>Number of points in <code>z_to</code>. </td></tr>
    <tr><td class="paramname">n_from</td><td>Number of points in <code>z_from</code>. </td></tr>
    <tr><td class="paramname">derivative</td><td>Specifies if we want the derivative interpolation instead, e.g. <code>derivative = 1</code> refers to the first derivative etc. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d90/fast3d_8f90_source.html#l00243">243</a> of file <a class="el" href="../../dd/d90/fast3d_8f90_source.html">fast3d.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dc/d5b/namespacefast3d_aaf25d1aac3262e9adea18d25b10b2ddc_cgraph.png" border="0" usemap="#adc/d5b/namespacefast3d_aaf25d1aac3262e9adea18d25b10b2ddc_cgraph" alt=""/></div>
<map name="adc/d5b/namespacefast3d_aaf25d1aac3262e9adea18d25b10b2ddc_cgraph" id="adc/d5b/namespacefast3d_aaf25d1aac3262e9adea18d25b10b2ddc_cgraph">
<area shape="rect" title="Compute interpolation weights for points z_to using values at points z_from." alt="" coords="5,5,144,31"/>
<area shape="rect" href="../../dc/d5b/namespacefast3d.html#a8cf69d1d964e71a541204bd6c2fc41c4" title="Compute finite&#45;difference stencil weights for evaluating derivatives up to order &#160;at a point." alt="" coords="192,5,363,31"/>
<area shape="poly" title=" " alt="" coords="144,15,178,15,178,21,144,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dc/d5b/namespacefast3d_aaf25d1aac3262e9adea18d25b10b2ddc_icgraph.png" border="0" usemap="#adc/d5b/namespacefast3d_aaf25d1aac3262e9adea18d25b10b2ddc_icgraph" alt=""/></div>
<map name="adc/d5b/namespacefast3d_aaf25d1aac3262e9adea18d25b10b2ddc_icgraph" id="adc/d5b/namespacefast3d_aaf25d1aac3262e9adea18d25b10b2ddc_icgraph">
<area shape="rect" title="Compute interpolation weights for points z_to using values at points z_from." alt="" coords="271,31,409,56"/>
<area shape="rect" href="../../d9/da0/namespaceinterpolation.html#ad32c9456866b0fda31f8dce40e54bc71" title="Constructor to initialize with two different spaces." alt="" coords="5,5,223,31"/>
<area shape="poly" title=" " alt="" coords="257,37,223,33,223,28,257,31"/>
<area shape="rect" href="../../d5/d0d/namespacespace.html#aea7cdf9a8933056da79e3b73f4e0ed49" title="Initialize a function space s with given polynomial dimensions." alt="" coords="47,55,181,80"/>
<area shape="poly" title=" " alt="" coords="257,55,182,63,181,58,257,49"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dc/d5b/namespacefast3d.html">fast3d</a></li>
    <li class="footer">Generated on Sat Dec 20 2025 03:48:21 for Neko by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
