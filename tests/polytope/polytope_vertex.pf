@test
subroutine test_vertex_init
  use pfunit
  use num_types, only : i4
  use vertex, only : vertex_t
  implicit none
  type(vertex_t) :: vertex, vertexo
  integer(i4) :: dim, nfacet, nridge, npeak, id1, id2

  ! test setting polytopes
  @assertEqual(vertex%dim(), -1)
  call vertex%set_dim(0)
  @assertEqual(vertex%dim(), 0)
  call vertex%set_nelem(0, 0, 0)
  call vertex%nelem(nfacet, nridge, npeak)
  @assertEqual(nfacet, 0)
  @assertEqual(nridge, 0)
  @assertEqual(npeak, 0)

  ! test vertex global id
  id1 = 1
  id2 = 2
  call vertex%init(id1)
  call vertexo%init(id1)
  @assertEqual(vertex%id(), id1)
  @assertTrue(vertex.eq.vertexo)
  call vertexo%init(id2)
  @assertFalse(vertex.eq.vertexo)
end subroutine test_vertex_init
