@test
subroutine test_octree_init
  use pfunit
  use octree
  implicit none

  type(octree_t) :: t

  @assertFalse(associated(t%root))
  call t%init(10d0)
  @assertTrue(associated(t%root))

end subroutine test_octree_init

@test
subroutine test_octree_free
  use pfunit
  use octree
  implicit none

  type(octree_t) :: t

  call t%init(1d0)
  @assertTrue(associated(t%root))

  call t%free
  @assertFalse(associated(t%root))

end subroutine test_octree_free

@test
subroutine test_octree_insert
  use pfunit
  use octree
  use point
  implicit none

  type(octree_t) :: t
  type(point_t) :: p
  integer :: i

  call t%init(100d0)

  do i = 1, 10
     call p%init(dble(i), dble(-i), dble(i))
     call t%insert(p)
  end do


end subroutine test_octree_insert

@test
subroutine test_octree_find
  use pfunit
  use octree
  use point
  use math
  implicit none

  type(octree_t) :: t
  type(point_t) :: p
  integer :: i

  call t%init(100d0)

  do i = 1, 10
     call p%init(dble(i), dble(-i), dble(i))
     call t%insert(p)
  end do

  do i = 10, 1, -1
     call p%init(dble(i), dble(-i), dble(i))
     @assertTrue(t%find(p))
  end do

  do i = 10, 1, -1
     call p%init(dble(-i), dble(-i), dble(i))
     @assertFalse(t%find(p))
  end do

end subroutine test_octree_find
